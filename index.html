<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Intent FreeDomain — int.yt</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #071226;
  --muted: #9ba3b8;
  --accent: #06b6d4;
  --accent2: #3b82f6;
  --text: #e6eef6;
  --danger: #ff6b6b;
  --ok: #7ef3d6;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,var(--bg),#071a2a);color:var(--text);-webkit-font-smoothing:antialiased}
header{position:sticky;top:0;z-index:60;display:flex;align-items:center;justify-content:space-between;padding:14px 20px;background:rgba(7,18,38,0.6);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,0.03)}
.brand{display:flex;gap:12px;align-items:center}
.logo-wrap{width:44px;height:44px;border-radius:14px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center}
.brand-title{font-weight:800;color:var(--text);font-size:20px}
nav a{margin-left:20px;color:var(--text);text-decoration:none;font-weight:500;opacity:0.8;transition:0.2s}
nav a:hover{opacity:1}
main{max-width:1100px;margin:24px auto;padding:0 18px 80px}
.panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:28px;border-radius:14px;border:1px solid rgba(255,255,255,0.05);margin-bottom:24px}
h1{margin-top:0;font-size:32px;font-weight:700}
.input-box{margin-top:20px;display:flex;gap:10px;flex-wrap:wrap}
.input-box input{flex:1;min-width:200px;padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.08);background:rgba(255,255,255,0.04);color:var(--text);font-size:16px}
.btn{background:linear-gradient(135deg,var(--accent),var(--accent2));padding:14px 24px;border-radius:10px;color:#fff;font-weight:600;border:none;cursor:pointer;transition:0.2s}
.btn:hover{transform:translateY(-2px);opacity:0.95}
.hint{margin-top:10px;color:var(--muted);font-size:14px}
.status { margin-top:12px; font-size:14px; padding:10px 12px; border-radius:10px; display:inline-block }
.status.ok{ background: rgba(123, 255, 210, 0.06); color: var(--ok); border:1px solid rgba(123, 255, 210, 0.08) }
.status.warn{ background: rgba(255, 214, 119, 0.04); color:#ffd39b; border:1px solid rgba(255,214,119,0.06) }
.status.err{ background: rgba(255,100,100,0.04); color:var(--danger); border:1px solid rgba(255,100,100,0.06) }
.suggestions{margin-top:12px;color:var(--muted);font-size:13px}
small{color:var(--muted)}
footer{text-align:center;color:var(--muted);padding:24px;font-size:14px;opacity:0.8}
@media(max-width:700px){.input-box{flex-direction:column}}
</style>
</head>
<body>
<header>
  <div class="brand">
    <div class="logo-wrap" aria-hidden="true"></div>
    <div>
      <div class="brand-title">Intent FreeDomain</div>
      <div style="font-size:12px;color:var(--muted)">Free subdomains • int.yt</div>
    </div>
  </div>
  <nav>
    <a href="about.html">About</a>
    <a href="register.html">Register</a>
    <a href="dashboard.html">Dashboard</a>
  </nav>
</header>

<main>
  <div class="panel">
    <h1>Get your free subdomain under <strong>int.yt</strong></h1>
    <p class="hint">Pick a short name — we will auto-prepend <code>.int.yt</code> for you. Names of length 1–3 are not allowed for registration (minimum 4 characters).</p>

    <div class="input-box">
      <input id="nameInput" type="text" placeholder="Enter desired name (e.g. yourname)" autocomplete="off" />
      <button id="checkBtn" class="btn">Check & Register</button>
    </div>

    <div id="statusBox" class="status" style="display:none"></div>
    <div id="suggestions" class="suggestions" style="display:none"></div>
    <div class="hint" style="margin-top:12px"><small>Example: <strong>user1.int.yt</strong></small></div>
  </div>

  <div class="panel">
    <h2>Why Intent?</h2>
    <ul>
      <li>Instant subdomains</li>
      <li>Simple NS management</li>
      <li>Secure, fast, and free</li>
    </ul>
  </div>
</main>

<footer>
  Intent FreeDomain — int.yt © 2025
</footer>

<script>
/* CONFIG: change API_BASE if needed */
const API_BASE = 'https://backend-render-gehg.onrender.com';

const input = document.getElementById('nameInput');
const btn = document.getElementById('checkBtn');
const statusBox = document.getElementById('statusBox');
const suggestions = document.getElementById('suggestions');

let checkTimer = null;
let lastChecked = '';

function showStatus(type, text){
  statusBox.style.display = 'inline-block';
  statusBox.className = 'status ' + (type === 'ok' ? 'ok' : (type === 'warn' ? 'warn' : 'err'));
  statusBox.textContent = text;
}
function hideStatus(){ statusBox.style.display='none'; statusBox.textContent=''; }
function showSuggestions(list){
  if(!list || list.length===0){ suggestions.style.display='none'; suggestions.innerHTML=''; return; }
  suggestions.style.display='block';
  suggestions.innerHTML = '<strong>Suggestions:</strong> ' + list.map(x => `<code style="margin-left:8px">${x}</code>`).join('');
}

function generateSuggestions(name){
  const out = [];
  if(!name) return out;
  // append numbers
  out.push(name + '123');
  out.push(name + '-dev');
  out.push(name + '-home');
  // prepend short words
  out.push('my' + name);
  out.push(name + 'blog');
  return out;
}

function validateNameLocal(name){
  // allowed chars letters numbers dash, length >=4
  const re = /^[a-z0-9-]{4,30}$/i;
  if(!name) return { ok:false, reason:'empty' };
  if(name.length < 4) return { ok:false, reason:'too-short' };
  if(!re.test(name)) return { ok:false, reason:'invalid-chars' };
  return { ok:true };
}

async function checkAvailability(name){
  // Update UI while checking
  showStatus('warn', 'Checking availability...');
  suggestions.style.display='none';

  // local validate first
  const local = validateNameLocal(name);
  if(!local.ok){
    if(local.reason === 'too-short') {
      showStatus('err', 'Names with 1–3 characters are not allowed. Use 4+ chars.');
      showSuggestions(generateSuggestions(name));
      return { available:false, reason:'too-short' };
    }
    showStatus('err', 'Name must be 4–30 characters and contain only letters, numbers, or dash.');
    return { available:false, reason:'invalid' };
  }

  // try backend check endpoint
  try{
    const res = await fetch(API_BASE + '/api/check?name=' + encodeURIComponent(name), { method:'GET' });
    if(res.status === 404){
      // backend has no check endpoint -> fallback
      hideStatus();
      showStatus('warn', 'Availability check not available — try registering.');
      showSuggestions(generateSuggestions(name));
      return { available: null, reason: 'no-check-endpoint' };
    }
    const j = await res.json();
    if(j && j.available){
      showStatus('ok', name + '.int.yt is available!');
      showSuggestions(generateSuggestions(name));
      return { available:true };
    } else {
      const r = (j && j.reason) ? j.reason : 'already-taken';
      showStatus('err', name + '.int.yt is taken — try a suggestion');
      showSuggestions(generateSuggestions(name));
      return { available:false, reason:r };
    }
  }catch(e){
    // network / CORS / unreachable
    showStatus('warn', 'Unable to check now (network). You can still try to register.');
    showSuggestions(generateSuggestions(name));
    return { available: null, reason:'network' };
  }
}

// debounce input
input.addEventListener('input', (e)=>{
  const name = input.value.trim();
  if(checkTimer) clearTimeout(checkTimer);
  checkTimer = setTimeout(()=> {
    if(!name) { hideStatus(); showSuggestions([]); return; }
    if(lastChecked === name) return;
    lastChecked = name;
    checkAvailability(name);
  }, 450);
});

// click handler -> redirect to register with name param
btn.addEventListener('click', async ()=>{
  const name = input.value.trim();
  if(!name){
    alert('Enter a subdomain name first.');
    input.focus();
    return;
  }
  // local client validation
  const local = validateNameLocal(name);
  if(!local.ok){
    if(local.reason === 'too-short') { alert('Names with 1–3 characters are not allowed. Use 4+ characters.'); input.focus(); return; }
    alert('Name must be 4–30 characters and only contain letters, numbers, or dash.'); input.focus(); return;
  }
  // direct redirect to register (backend will still validate on server)
  window.location.href = '/register.html?name=' + encodeURIComponent(name);
});

</script>
</body>
</html>
